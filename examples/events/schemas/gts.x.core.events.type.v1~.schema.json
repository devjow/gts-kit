{
  "$id": "gts://gts.x.core.events.type.v1~",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Event Envelope (Common Fields)",
  "type": "object",
  "description": "Base event type definition",
  "required": [
    "id",
    "type",
    "tenantId",
    "occurredAt"
  ],
  "x-event-type-settings": {
    "additionalProperties": false,
    "topicRef": {
      "description": "ID of the topic where events of this type are stored.",
      "type": "string",
      "x-gts-type":"gts.x.core.events.topic.v1~"
    }
  },
  "properties": {
    "type": {
      "description": "Identifier of the event type in GTS format.",
      "type": "string",
      "x-gts-type": "./$id"
    },
    "$schema": {
      "description": "Link to the event type schema.",
      "type": "string"
    },
    "id": {
      "type": "string",
      "format": "uuid"
    },
    "tenantId": {
      "type": "string",
      "format": "uuid",
      "description": "The id of the tenant that produced the event. Mandatory"
    },
    "userId": {
      "type": "string",
      "format": "uuid",
      "description": "The id of the user that produced the event. Optional"
    },
    "clientId": {
      "type": "string",
      "format": "uuid",
      "description": "The id of the API client that produced the event. Optional"
    },
    "source": {
      "description": "Full SemVer of the event type schema used to produce this event.",
      "type": "string",
      "maxLength": 256
    },
    "occurredAt": {
      "type": "string",
      "format": "date-time",
      "description": "The time the event occurred. Fully controlled by the producer"
    },
    "ingestedAt": {
      "type": "string",
      "format": "date-time",
      "description": "The time the event was ingested into the event store.",
      "$readonly": true
    },
    "sequenceNumber": {
      "type": "number",
      "description": "The sequence number of the event in the stream."
    },
    "previousSequenceNumber": {
      "type": "number",
      "description": "The sequence number of the previous event in the same stream."
    },
    "payload": {
      "description": "Type-specific body; see event type schema.",
      "type": "object"
    },
    "subject": {
      "description": "The subject of the event.",
      "type": "string"
    },
    "subjectType": {
      "description": "GTS type of the subject of the event.",
      "type": "string",
      "x-gts-type": "*",
      "$comment": "The value is mandatory if subject is present"
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "type": "gts://gts.x.core.events.type.v1~x.commerce.orders.order_placed.v1~",
      "$schema": "gts://gts.x.core.events.type.v1~x.commerce.orders.order_placed.v1~",
      "tenantId": "770e8400-e29b-41d4-a716-446655440001",
      "userId": "880e8400-e29b-41d4-a716-446655440002",
      "source": "order-service/v1.2.3",
      "occurredAt": "2024-01-15T10:30:00Z",
      "sequenceNumber": 12345,
      "subject": "order-123",
      "subjectType": "gts://gts.x.commerce.orders.order.v1.0~",
      "payload": {
        "orderId": "order-123",
        "customerId": "customer-456",
        "totalAmount": 99.99,
        "currency": "USD"
      }
    },
    {
      "id": "660e8400-e29b-41d4-a716-446655440003",
      "type": "gts://gts.x.core.events.type.v1~x.core.idp.contact_created.v1~",
      "$schema": "gts://gts.x.core.events.type.v1~x.core.idp.contact_created.v1~",
      "tenantId": "770e8400-e29b-41d4-a716-446655440001",
      "clientId": "990e8400-e29b-41d4-a716-446655440004",
      "source": "idp-service/v2.0.1",
      "occurredAt": "2024-01-15T11:00:00Z",
      "ingestedAt": "2024-01-15T11:00:01Z",
      "sequenceNumber": 67890,
      "previousSequenceNumber": 67889,
      "subject": "contact-789",
      "subjectType": "gts://gts.x.core.idp.contact.v1.0~",
      "payload": {
        "contactId": "contact-789",
        "email": "new.user@example.com",
        "name": "New User"
      }
    }
  ]
}
